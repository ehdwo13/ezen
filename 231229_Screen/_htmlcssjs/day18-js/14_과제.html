<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<style>
    li{
        list-style: decimal;
    }
</style>
<body>
    <h1>
        컴퓨터가 숫자 0~9까지 중복되지 않는 정수 3개를 랜덤을 출제 맞추는게임
    </h1>
    <ul>
        <li>
            세자리의 숫자는 중복되면 안됨. (각 숫자는 자리수를 갖고 있음)
        </li>
        <li>
            각 자리수와 입력한 숫자가 일치하면 1Strike (스트라이크)
        </li>
        <li>
            숫자만 포함되어 있으면 1Ball(볼)
        </li>
        <li>
            숫자가 전혀 없으면 out(아웃)
        </li>
        <li>
            3 스트라이크면 게임 종료
        </li>
    </ul>
    <hr>
    <button type="button" id="makeRan">게임 시작</button>
    <h1 id="printCom"></h1>
    숫자 입력 : <input type="text" id="input"><button type="button" id="check">게임 확인</button>
    <ul id="printResult">

    </ul>
    <script>
        const ranSet = new Set;
        const mySet = new Set;
        const makeRan = document.getElementById('makeRan');
        const printCom = document.getElementById('printCom');
        const input = document.getElementById('input');
        const check = document.getElementById('check');
        const printResult = document.getElementById('printResult');
        let str = "";
        let stkCount = 0;
        let ballCount = 0;
        let outCount = 0;

        makeRan.addEventListener('click',()=>{
            while(ranSet.size<3){
                let ran = Math.floor(Math.random()*10);
                ranSet.add(ran);
            }
            console.log(ranSet); //테스트
            printCom.innerText = `컴퓨터가 숫자를 결정했습니다.`;
        })
        check.addEventListener('click', ()=>{
            mySet.clear();
            let inputStr = input.value;
            input.value = null;
            if(regExpVali(inputStr)){
                let first = Number(inputStr.substr(0,1));
                let second = Number(inputStr.substr(1,1));
                let third = Number(inputStr.substr(2,1));
                mySet.add(first);
                mySet.add(second);
                mySet.add(third);
                checkMy(mySet);
                if(outCount == 9){
                    printResult.innerHTML += `<li>OUT!!</li>`
                }else if(stkCount ==3){
                    printResult.innerHTML += `<li>success!!</li>`
                }else{
                    printResult.innerHTML += `<li>${first}, ${second}, ${third} => ${stkCount}strike , ${ballCount}ball</li>`
                }
            }
        })
        function checkMy(someSet){
            stkCount = 0;
            ballCount = 0;
            ranSet.values().forEach(function (v,i){
                someSet.values().forEach(function (mv,mi){
                    checkBaseBall(mv,v,mi,i);
                })
            })
        }
        function checkBaseBall(value,setValue,index,setIndex){
            if(value==setValue && index == setIndex){
                return stkCount++;
            }else if(value==setValue && index != setIndex){
                return ballCount++;
            }else{
                return outCount++;
            }
        }
        function regExpVali(string){
            //공백 숫자인지아닌지 3개이상 중복숫자
            if(string=="" || /\s/.test(string)){
                printCom.innerText = '공백은 유효하지 않습니다.'
            }else if(/\D/.test(string)){
                printCom.innerText = '유효하지 않는 숫자입니다.'
            }else if(string.length>3 || string.length<3){
                printCom.innerText = '숫자 3개를 입력해주세요.'
            }else if((string.substr(0,1))==(string.substr(1,1))||(string.substr(1,1))==(string.substr(2,1))||(string.substr(2,1))==(string.substr(0,1))){
                printCom.innerText = '숫자는 중복될 수 없습니다.'
            }else{
                printCom.innerText = '컴퓨터가 숫자를 결정했습니다.'
                return true;
            }
        }
    </script>
</body>
</html>